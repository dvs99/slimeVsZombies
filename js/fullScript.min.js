let btnLevels,btnAbout,btnTraining,slime,zombie,animSLime,animZombie,fondo1,soundExpl,slimeTrain,animSlimeTrain,rotateLeftTraining,rotateRightTraining,dashSlimeTraining,control,holdDuration,buttonBackTraining,initState={preload:preloadInit,create:createInit};function preloadInit(){game.load.image("button1","assets/imgs/boton1.png"),game.load.image("button2","assets/imgs/boton2.png"),game.load.image("button3","assets/imgs/boton3.png"),game.load.image("fondo1","assets/imgs/fondo2.png"),game.load.image("titulo","assets/imgs/titulo.png"),game.load.spritesheet("slimeJump","assets/imgs/Slime1.png",29,26,11),game.load.spritesheet("zombie1","assets/imgs/Zombie1.png",29,26,6),game.load.spritesheet("slimeBlast","assets/imgs/slimeBlast.png",128,128),game.load.spritesheet("zombieBlast","assets/imgs/zombieBlast.png",128,128),game.load.audio("sndExplosion","assets/sounds/Explosion.wav"),game.load.audio("musicMenu","assets/sounds/MenuMusic.wav"),game.load.audio("musicPlay","assets/sounds/MusicLevel.wav")}function createInit(){fondo1=game.add.image(0,0,"fondo1"),titulo=game.add.image(265,20,"titulo"),titulo.scale.setTo(3,3),titulo.smoothed=!1,(btnTraining=game.add.button(650,300,"button3",startTraining)).scale.setTo(.6,.6),btnTraining.anchor.setTo(.5,.5),btnTraining.onInputOver.add(grow),btnTraining.onInputOut.add(smaller),(btnAbout=game.add.button(150,300,"button2",startAbout)).scale.setTo(.6,.6),btnAbout.anchor.setTo(.5,.5),btnAbout.onInputOver.add(grow),btnAbout.onInputOut.add(smaller),(btnLevels=game.add.button(400,400,"button1",startPlay)).scale.setTo(.6,.6),btnLevels.anchor.setTo(.5,.5),btnLevels.onInputOver.add(grow),btnLevels.onInputOut.add(smaller),createSlime(),createZombie(),createSounds(),musicMenu.isPlaying||musicMenu.play()}function createSounds(){soundExpl=game.add.audio("sndExplosion"),null==musicMenu&&(musicMenu=game.add.audio("musicMenu",.4,1,!0)),null==musicLevel&&(musicLevel=game.add.audio("musicPlay",.35,1,!0))}function grow(e){e.scale.setTo(.7,.7)}function smaller(e){e.scale.setTo(.6,.6)}function createSlime(){(slime=game.add.button(29,26,"slimeJump",createSlimeBlast)).x=125,slime.y=400,slime.smoothed=!1,slime.scale.setTo(4,4),animSLime=slime.animations.add("jump"),slime.animations.play("jump",6,!0)}function createSlimeBlast(){xi=slime.x,yi=slime.y,slime.kill(),(slime=game.add.sprite(29,26,"slimeBlast")).x=xi-35,slime.y=yi-40,slime.scale.setTo(1.5,1.5),animSLime=slime.animations.add("slimeBlast"),slime.animations.play("slimeBlast",17,!1),game.time.events.add(1500,createSlime,this),soundExpl.play()}function createZombie(){(zombie=game.add.button(29,26,"zombie1",createZombieBlast)).x=560,zombie.y=400,zombie.smoothed=!1,zombie.scale.setTo(4,4),animZombie=zombie.animations.add("animZombie"),zombie.animations.play("animZombie",6,!0)}function createZombieBlast(){xi=zombie.x,yi=zombie.y,zombie.kill(),(zombie=game.add.sprite(29,26,"zombieBlast")).x=xi-35,zombie.y=yi-40,zombie.scale.setTo(1.5,1.5),soundExpl.play(),animZombie=zombie.animations.add("zombieBlast"),zombie.animations.play("zombieBlast",17,!1),game.time.events.add(1500,createZombie,this)}function startPlay(){game.state.start("levels")}function startAbout(){game.state.start("about")}function startTraining(){game.state.start("training")}const ROTATE_VELOCITY=5,DASH_VELOCITY=150,MAX_HOLD_DURATION=2e3;let end,shots,shotBtn,animShot,shotSound,mutants,zombies,blasts,zombieDeath,mutantShots,trainState1={preload:preloadTrain1,create:createTrain1,update:updateTrain1};function preloadTrain1(){game.load.spritesheet("slimeMove","assets/imgs/SlimeMov.png",25,29,7),game.load.image("soilNormal","assets/imgs/DirtBlock.png"),game.load.image("soilFast","assets/imgs/IceBlock.png"),game.load.image("soilSlow","assets/imgs/MudBlock.png"),game.load.image("buttonBack","assets/imgs/btnBack.png")}function createTrain1(){musicMenu.pause(),musicLevel.isPlaying||musicLevel.play(),game.world.resize(1600,1200),createBackground(),createSlimeTrain(),createButton(),createKeyControlsTraining(),end=!1}function createButton(){(btnTraining=game.add.button(60,550,"buttonBack",backTraining)).fixedToCamera=!0,btnTraining.scale.setTo(.2,.2),btnTraining.anchor.setTo(.5,.5),btnTraining.onInputOver.add(growT),btnTraining.onInputOut.add(smallerT)}function backTraining(){musicLevel.isPlaying&&musicLevel.pause(),game.state.start("init")}function growT(e){e.scale.setTo(.25,.25)}function smallerT(e){e.scale.setTo(.2,.2)}function createBackground(){tileNormal1=game.add.tileSprite(0,0,800,600,"soilNormal"),tileNormal2=game.add.tileSprite(800,600,800,600,"soilNormal"),tileFast=game.add.tileSprite(0,600,800,600,"soilFast"),tileSlow=game.add.tileSprite(800,0,800,600,"soilSlow"),game.physics.arcade.enable(tileFast),tileFast.body.immovable=!0,tileFast.body.moves=!1,game.physics.arcade.enable(tileSlow)}function createSlimeTrain(){slimeTrain=game.add.sprite(29,26,"slimeMove"),game.physics.arcade.enable(slimeTrain),slimeTrain.body.collideWorldBounds=!0,slimeTrain.x=400,slimeTrain.y=300,slimeTrain.anchor.setTo(.5,.5),slimeTrain.smoothed=!1,slimeTrain.scale.setTo(2,2),animSLimeTrain=slimeTrain.animations.add("move")}function updateTrain1(){moveSlimeTraining(),decreaseVelocity(),moveCamera()}function moveCamera(){end||(game.camera.x=slimeTrain.x-400,game.camera.y=slimeTrain.y-300)}function createKeyControlsTraining(){let e=document.getElementById("gamestage").children[0];e.addEventListener("mouseout",activateKeyboard),e.addEventListener("mouseover",deactivateKeyboard),cursors=game.input.keyboard.createCursorKeys(),rotateLeftTraining=game.input.keyboard.addKey(Phaser.Keyboard.LEFT),rotateRightTraining=game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),dashSlimeTraining=game.input.keyboard.addKey(Phaser.Keyboard.UP)}function activateKeyboard(){control=1}function deactivateKeyboard(){control=0}function moveSlimeTraining(){if(0==control){if(0==slimeTrain.body.velocity.y&0==slimeTrain.body.velocity.x&&(slimeTrain.angle=180*Phaser.Math.angleBetween(slimeTrain.x,slimeTrain.y,game.input.x+game.camera.x,game.input.y+game.camera.y)/Math.PI+90),game.input.mousePointer.rightButton.duration>=0&&(holdDuration=game.input.mousePointer.rightButton.duration+500),game.input.activePointer.rightButton.justReleased(30)){let e=Math.cos((slimeTrain.angle-90)*Math.PI/180),a=Math.sin((slimeTrain.angle-90)*Math.PI/180);holdDuration>MAX_HOLD_DURATION&&(holdDuration=MAX_HOLD_DURATION),slimeTrain.body.velocity.y=a*DASH_VELOCITY*holdDuration/1e3,slimeTrain.body.velocity.x=e*DASH_VELOCITY*holdDuration/1e3,slimeTrain.animations.play("move",750/Math.abs(Math.sqrt(slimeTrain.body.velocity.y*slimeTrain.body.velocity.y+slimeTrain.body.velocity.x*slimeTrain.body.velocity.x)),!1)}}else if(1==control&&(0==slimeTrain.body.velocity.y&0==slimeTrain.body.velocity.x&rotateLeftTraining.isDown?slimeTrain.angle-=ROTATE_VELOCITY:0==slimeTrain.body.velocity.y&0==slimeTrain.body.velocity.x&rotateRightTraining.isDown&&(slimeTrain.angle+=ROTATE_VELOCITY),dashSlimeTraining.justUp)){let e=Math.cos((slimeTrain.angle-90)*Math.PI/180),a=Math.sin((slimeTrain.angle-90)*Math.PI/180),t=dashSlimeTraining.duration+500;t>MAX_HOLD_DURATION&&(t=MAX_HOLD_DURATION),slimeTrain.body.velocity.y=a*DASH_VELOCITY*t/1e3,slimeTrain.body.velocity.x=e*DASH_VELOCITY*t/1e3,slimeTrain.animations.play("move",750/Math.abs(Math.sqrt(slimeTrain.body.velocity.y*slimeTrain.body.velocity.y+slimeTrain.body.velocity.x*slimeTrain.body.velocity.x)),!1)}}function decreaseVelocity(){(slimeTrain.body.velocity.y>0||slimeTrain.body.velocity.y<0)&&(slimeTrain.body.velocity.y/=1.012),(slimeTrain.body.velocity.x>0||slimeTrain.body.velocity.x<0)&&(slimeTrain.body.velocity.x/=1.012),Math.abs(Math.sqrt(slimeTrain.body.velocity.y*slimeTrain.body.velocity.y+slimeTrain.body.velocity.x*slimeTrain.body.velocity.x)<35)&&(slimeTrain.body.velocity.y=0,slimeTrain.body.velocity.x=0),game.physics.arcade.overlap(slimeTrain,tileFast)?(slimeTrain.body.velocity.y*=1.009,slimeTrain.body.velocity.x*=1.009):6==slimeTrain.animations.frame&&(slimeTrain.body.velocity.y/=1.5,slimeTrain.body.velocity.x/=1.5),game.physics.arcade.overlap(slimeTrain,tileSlow)&&(slimeTrain.body.velocity.y/=1.01,slimeTrain.body.velocity.x/=1.01)}let countAngleSwitch=0;const SHOTS_GROUP_SIZE=40,BLAST_GROUP_SIZE=20,MUTANTS_GROUP_SIZE=7,ZOMBIES_GROUP_SIZE=15,SWITCH_ANGLE_TIME=7;let times,access1,access2,access3,victory1,victory2,victory3,trainState2={preload:preloadTrain2,create:createTrain2,update:updateTrain2};function preloadTrain2(){game.load.spritesheet("slimeMove","assets/imgs/SlimeMov.png",25,29,7),game.load.image("soilNormal","assets/imgs/DirtBlock.png"),game.load.image("soilFast","assets/imgs/IceBlock.png"),game.load.image("soilSlow","assets/imgs/MudBlock.png"),game.load.image("buttonBack","assets/imgs/btnBack.png"),game.load.spritesheet("slimeMutant","assets/imgs/ZombieMutante.png",25,26,2),game.load.spritesheet("slimeZombie","assets/imgs/zombieNormal.png",25,26,2),game.load.spritesheet("slimeShot","assets/imgs/SlimeShot.png",10,11,8),game.load.spritesheet("mutantShot","assets/imgs/mutantShot.png",8,8,8),game.load.audio("shotSound","assets/sounds/shotSound.wav"),game.load.audio("zombieDeath","assets/sounds/Explosion.wav"),game.load.spritesheet("zombieBlast","assets/imgs/zombieBlast.png",128,128)}function createTrain2(){musicMenu.pause(),musicLevel.isPlaying||musicLevel.play(),game.world.resize(1600,1200),createBackground(),createSlimeTrain(),createKeyControlsTraining(),shotBtn=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),createShots(SHOTS_GROUP_SIZE),createMutantShots(SHOTS_GROUP_SIZE),createSoundsTraining(),createMutants(MUTANTS_GROUP_SIZE),createZombies(ZOMBIES_GROUP_SIZE),createButton(),createBlasts(BLAST_GROUP_SIZE),end=!1}function createMutants(e){(mutants=game.add.group()).createMultiple(e,"slimeMutant"),mutants.callAll("anchor.setTo","anchor",.5,.5),mutants.callAll("scale.setTo","scale",2,2),mutants.forEach(placeMutant,this),mutants.forEach(function(e){game.time.events.add(2500,mutantShot,e,this)},this)}function createZombies(e){(zombies=game.add.group()).createMultiple(e,"slimeZombie"),zombies.callAll("anchor.setTo","anchor",.5,.5),zombies.callAll("scale.setTo","scale",2,2),zombies.forEach(placeZombie,this)}function placeMutant(e){let a=!1;for(;!a;){let t=1600*Math.random(),i=1200*Math.random();Phaser.Math.distance(slimeTrain.x,slimeTrain.y,t,i)>150&&(game.physics.arcade.enable(e),e.reset(t,i),e.body.immovable=!0,e.animations.add("mutantIdle"),e.animations.play("mutantIdle",4,!0),a=!0)}}function placeZombie(e){let a=!1;for(;!a;){let t=1600*Math.random(),i=1200*Math.random();Phaser.Math.distance(slimeTrain.x,slimeTrain.y,t,i)>150&&(game.physics.arcade.enable(e),e.reset(t,i),e.body.immovable=!0,e.animations.add("slimeZombie"),e.animations.play("slimeZombie",4,!0),a=!0)}}function createShots(e){(shots=game.add.group()).enableBody=!0,shots.createMultiple(e,"slimeShot"),shots.callAll("scale.setTo","scale",2,2),shots.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),shots.callAll("anchor.setTo","anchor",.5,.5),shots.setAll("checkWorldBounds",!0)}function createMutantShots(e){(mutantShots=game.add.group()).enableBody=!0,mutantShots.createMultiple(e,"mutantShot"),mutantShots.callAll("scale.setTo","scale",2,2),mutantShots.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),mutantShots.callAll("anchor.setTo","anchor",.5,.5),mutantShots.setAll("checkWorldBounds",!0)}function createBlasts(e){(blasts=game.add.group()).createMultiple(e,"zombieBlast"),blasts.forEach(setupBlast,this)}function setupBlast(e){e.anchor.x=.5,e.anchor.y=.5,e.animations.add("zombieBlast")}function createSoundsTraining(){shotSound=game.add.audio("shotSound"),zombieDeath=game.add.audio("zombieDeath")}function updateTrain2(){moveSlimeTraining(),decreaseVelocity(),moveCamera(),manageShots(),game.physics.arcade.collide(mutants,slimeTrain),game.physics.arcade.collide(slimeTrain,zombie),game.physics.arcade.overlap(mutants,shots,shotHitsEnemy,null,this),game.physics.arcade.overlap(slimeTrain,mutantShots,shotHitsPlayer,null,this),game.physics.arcade.overlap(zombies,shots,shotHitsEnemy,null,this),mutants.forEach(manageMutant,this),manageZombies()}function manageZombies(){countAngleSwitch++,zombies.forEach(manageZombie,this),countAngleSwitch==SWITCH_ANGLE_TIME&&(countAngleSwitch=0)}function shotHitsPlayer(e,a){a.kill()}function shotHitsEnemy(e,a){a.kill(),e.kill(),displayBlast(e),zombieDeath.play()}function displayBlast(e){let a=blasts.getFirstExists(!1),t=e.x,i=e.y;a.reset(t,i),a.play("zombieBlast",30,!1,!0)}function manageMutant(e){Phaser.Math.distance(slimeTrain.x,slimeTrain.y,e.x,e.y)<400&&e.alive&&(e.angle=180*Phaser.Math.angleBetween(e.x,e.y,slimeTrain.x,slimeTrain.y)/Math.PI+90)}function manageZombie(e){if(Phaser.Math.distance(slimeTrain.x,slimeTrain.y,e.x,e.y)<250&&e.alive?e.angle=180*Phaser.Math.angleBetween(e.x,e.y,slimeTrain.x,slimeTrain.y)/Math.PI+90:countAngleSwitch==SWITCH_ANGLE_TIME&&(e.angle+=60*Math.random()-30,e.y<30&&e.x<30?e.angle=135:e.y<30&&e.x>1570?e.angle=225:e.y>1170&&e.x>1570?e.angle=315:e.y>1170&&e.x<30?e.angle=45:(e.y<100?e.angle=180:e.y>1100&&(e.angle=0),e.x<100?e.angle=90:e.x>1500&&(e.angle=270))),!game.physics.arcade.collide(slimeTrain,e)){let a=Math.cos((e.angle-90)*Math.PI/180),t=Math.sin((e.angle-90)*Math.PI/180);e.x+=a/2,e.y+=t/2}}function mutantShot(e){if(Phaser.Math.distance(slimeTrain.x,slimeTrain.y,e.x,e.y)<400&&e.alive){let a=Math.cos((e.angle-90)*Math.PI/180),t=Math.sin((e.angle-90)*Math.PI/180);shoot(e.x+a+25*a,e.y+t+25*t,200*a,200*t,"mutantShot",mutantShots,e.angle)}game.time.events.add(2500,mutantShot,e,this)}function manageShots(){if(shotBtn.justDown&&1==control||game.input.mousePointer.leftButton.justPressed(30)){let e=Math.cos((slimeTrain.angle-90)*Math.PI/180),a=Math.sin((slimeTrain.angle-90)*Math.PI/180);shoot(slimeTrain.x+e+25*e,slimeTrain.y+a+25*a,400*e,400*a,"slimeShot",shots,slimeTrain.angle)&&shotSound.play()}}function shoot(e,a,t,i,s,o,n){let l=o.getFirstExists(!1);return l&&(l.reset(e,a),l.body.velocity.y=i,l.body.velocity.x=t,l.angle=n,animShot=l.animations.add(s),l.animations.play(s,10,!0)),l}function resetMember(e){e.kill()}let levelsState={preload:preloadLevels,create:createLevels};function preloadLevels(){game.load.image("buttonLV1","assets/imgs/ButtonLevel1.png"),game.load.image("buttonLV2","assets/imgs/ButtonLevel2.png"),game.load.image("buttonLV3","assets/imgs/ButtonLevel3.png"),game.load.image("buttonBack","assets/imgs/btnBack.png")}function createLevels(){fondo1=game.add.image(0,0,"fondo1"),titulo=game.add.image(265,20,"titulo"),titulo.scale.setTo(3,3),titulo.smoothed=!1,times=[],access1=!1,access2=!1,access3=!1,victory1=!1,victory2=!1,victory3=!1,createbtnLevel1(),createbtnLevel2(),createbtnLevel3(),createButtonAbout(),createSlimeLevelInit(),createZombieTrainInit1(),createZombieTrainInit2()}function createbtnLevel1(){btnLevel1=game.add.button(150,300,"buttonLV1",startLevel1),btnLevel1.scale.setTo(.6,.6),btnLevel1.anchor.setTo(.5,.5),btnLevel1.onInputOver.add(grow),btnLevel1.onInputOut.add(smaller)}function createbtnLevel2(){btnLevel2=game.add.button(400,300,"buttonLV2",startLevel2),btnLevel2.scale.setTo(.6,.6),btnLevel2.anchor.setTo(.5,.5),btnLevel2.onInputOver.add(grow),btnLevel2.onInputOut.add(smaller)}function createbtnLevel3(){btnLevel1=game.add.button(650,300,"buttonLV3",startLevel3),btnLevel1.scale.setTo(.6,.6),btnLevel1.anchor.setTo(.5,.5),btnLevel1.onInputOver.add(grow),btnLevel1.onInputOut.add(smaller)}function createSlimeLevelInit(){(slime=game.add.button(29,26,"slimeJump",createSlimeBlastLevelInit)).x=350,slime.y=400,slime.smoothed=!1,slime.scale.setTo(4,4),animSLime=slime.animations.add("jump"),slime.animations.play("jump",6,!0)}function createSlimeBlastLevelInit(){xi=slime.x,yi=slime.y,slime.kill(),(slime=game.add.sprite(29,26,"slimeBlast")).x=xi-35,slime.y=yi-40,slime.scale.setTo(1.5,1.5),animSLime=slime.animations.add("slimeBlast"),slime.animations.play("slimeBlast",17,!1),game.time.events.add(1500,createSlimeLevelInit,this),soundExpl.play()}function startLevel1(){game.state.start("level1")}function startLevel2(){game.state.start("level2")}function startLevel3(){game.state.start("level3")}const TEXT_HOR=30,TEXT_VER=30;let aboutState={preload:preloadAbout,create:createAbout};function preloadAbout(){game.load.image("buttonBack","assets/imgs/btnBack.png")}function createAbout(){fondo1=game.add.image(0,0,"fondo1"),createText(),createButtonAbout(),createSlimeAbout()}function createButtonAbout(){btnBackAbout=game.add.button(750,550,"buttonBack",backTraining),btnBackAbout.scale.setTo(.2,.2),btnBackAbout.anchor.setTo(.5,.5),btnBackAbout.onInputOver.add(growT),btnBackAbout.onInputOut.add(smallerT)}function createSlimeAbout(){(slime=game.add.button(29,26,"slimeJump",createSlimeBlastAbout)).x=500,slime.y=450,slime.smoothed=!1,slime.scale.setTo(-4,4),animSLime=slime.animations.add("jump"),slime.animations.play("jump",6,!0)}function createSlimeBlastAbout(){xi=slime.x,yi=slime.y,slime.kill(),(slime=game.add.sprite(29,26,"slimeBlast")).x=xi-155,slime.y=yi-40,slime.scale.setTo(1.5,1.5),animSLime=slime.animations.add("slimeBlast"),slime.animations.play("slimeBlast",17,!1),game.time.events.add(1500,createSlimeAbout,this),soundExpl.play()}function createText(){let e={font:"30px Abril Fatface",fontWeight:"bold",fill:"#FF3395"};game.add.text(TEXT_HOR,TEXT_VER+420,"SIN NOMBRE",e);let a="Alexandra Moreno Díez \n";a+="Diego Villabrille Seca \n",a+="Cristian Cantos Roselló";let t={font:"15px Baloo Da",fill:"#000000"};game.add.text(TEXT_HOR,TEXT_VER+460,"Alexandra Moreno Díez \nDiego Villabrille Seca \nCristian Cantos Roselló",t);game.add.text(TEXT_HOR,TEXT_VER,"INSTRUCTIONS",e);let i="LEVEL 1 AND 2\nYou´ll have to get all the candies before the time runs out or you will get killed.\n";i+="When you get the candies, you will have to go through the rainbow door that \n",i+="takes you to the next level or to the final screen.\n",i+="Objects that can hurt you are green and the ones which can´t hurt are pink. You \n",i+="can shoot enemies with the left mouse button or with the space.\n",i+="There are three ground types, the green ground makes you go slower, the ice \n",i+="ground makes you go faster. The normal ground has no effect.\n",i+="There are two power-ups, the shield (press X button to use it), which will protect \n",i+="you from everything, and the hammer (press Z button to use it) that will hit the \n",i+="ground and kill enemies that are nearby.\n\n",i+="LEVEL 3\n",i+="With the left and right arrow keys you move the character and with the up arrow\n",i+="key make the character jump. Press space to shoot the enemies.\n";game.add.text(TEXT_HOR,TEXT_VER+40,"LEVEL 1 AND 2\nYou´ll have to get all the candies before the time runs out or you will get killed.\nWhen you get the candies, you will have to go through the rainbow door that \ntakes you to the next level or to the final screen.\nObjects that can hurt you are green and the ones which can´t hurt are pink. You \ncan shoot enemies with the left mouse button or with the space.\nThere are three ground types, the green ground makes you go slower, the ice \nground makes you go faster. The normal ground has no effect.\nThere are two power-ups, the shield (press X button to use it), which will protect \nyou from everything, and the hammer (press Z button to use it) that will hit the \nground and kill enemies that are nearby.\n\nLEVEL 3\nWith the left and right arrow keys you move the character and with the up arrow\nkey make the character jump. Press space to shoot the enemies.\n",t)}let tileSizes=[128,160,192,224,256,288];const TILES_SIZE=5,NORMAL_OBJECTS_SIZE=15,DAMAGE_OBJECTS_SIZE=10,LIVES_SIZE=3,WIN_OBJECTS_SIZE=10,LEVEL_1_TIME=300,LEVEL_1_LIVES=5,HUD_STYLE_TIME={font:"bold 25pt Pacifico",fontWeight:"bold",fill:"#ffffff"},HUD_STYLE_TEXT={font:"bold 20pt Pacifico",fontWeight:"bold",fill:"#e312e5"};let fastTiles,slowTiles,tileNormal,normalObjects,damageObjects,winObjects,Sounddmg,lives,time,exit,objLeft,hudGroup,hudTime,hudObjects,hudLevel,hearts,currentLevel,inmunity,sc,collectPowerUp,hammerSound,shieldSound,liveItems,liveItem,level1State={preload:preloadLevel1,create:createLevel1,update:updateLevel1};function preloadLevel1(){game.load.spritesheet("slimeMove","assets/imgs/SlimeMov.png",25,29,7),game.load.image("soilNormal","assets/imgs/DirtBlock.png"),game.load.image("soilFast","assets/imgs/IceBlock.png"),game.load.image("soilSlow","assets/imgs/MudBlock.png"),game.load.image("bush","assets/imgs/Bush.png"),game.load.image("heart","assets/imgs/heart.png"),game.load.spritesheet("candy","assets/imgs/caramelo.png",256,156,2),game.load.image("cactus","assets/imgs/cactus.png"),game.load.spritesheet("vortex","assets/imgs/Vortice.png",161,165,27),game.load.image("tree","assets/imgs/Tree.png"),game.load.image("exitClosed","assets/imgs/La_puerta_hacia_el_dorado_negro.png"),game.load.image("exitOpen","assets/imgs/La_puerta_hacia_el_dorado.png"),game.load.audio("sndDamage","assets/sounds/DamageSound.wav"),game.load.audio("endsound","assets/sounds/EndSound.wav"),game.load.audio("exitsound","assets/sounds/Exit.wav"),game.load.audio("candysound","assets/sounds/candy.wav"),game.load.audio("collectPowerUp","assets/sounds/collectPowerUp.wav")}function createLevel1(){musicMenu.pause(),musicLevel.isPlaying||musicLevel.play(),game.world.resize(1600,1200),createBackgroundLevels(),hearts=[],times=[],victory1=!1,inmunity=!1,createExit(),createSlimeLevels(LEVEL_1_LIVES),createKeyControlsLevel1(),createNormalObjects(),createDamageObjects(),createWinObjects(),createLives(LIVES_SIZE),createSoundsLevel1(),time=LEVEL_1_TIME,currentLevel=1,access1=!0,createHUD(),timer(),end=!1,inmunity=!1}function createLives(e){liveItems=game.add.group();for(let a=0;a<e;a++){for((liveItem=game.add.sprite(28,24,"heart")).x=1520*Math.random(),liveItem.y=1120*Math.random(),game.physics.arcade.enable(liveItem),liveItem.body.immovable=!0;game.physics.arcade.overlap(liveItem,normalObjects)||game.physics.arcade.overlap(liveItem,damageObjects)||game.physics.arcade.overlap(liveItem,winObjects)||checkCoordinates(270,450,170,350,liveItem.x,liveItem.y)||checkCoordinates(660,850,460,650,liveItem.x,liveItem.y);)liveItem.destroy(),(liveItem=game.add.sprite(28,24,"heart")).x=1520*Math.random(),liveItem.y=1120*Math.random(),game.physics.arcade.enable(liveItem),liveItem.body.immovable=!0;liveItems.add(liveItem)}game.world.sendToBack(liveItems),game.world.sendToBack(fastTiles),game.world.sendToBack(slowTiles),game.world.sendToBack(tileNormal)}function createHUD(){hudGroup=game.add.group(),(hudTime=game.add.text(250,20,setRemainingTime(time),HUD_STYLE_TIME)).anchor.setTo(.5,.5),(hudObjects=game.add.text(700,575,"Objects left: "+objLeft,HUD_STYLE_TEXT)).anchor.setTo(.5,.5),(hudLevel=game.add.text(740,540,"Level: "+currentLevel,HUD_STYLE_TEXT)).anchor.setTo(.5,.5),hudGroup.add(hudLevel),hudGroup.add(hudObjects),hudGroup.add(hudTime),createHearts(hearts,LEVEL_1_LIVES,hudGroup),hudGroup.fixedToCamera=!0}function createHearts(e,a,t){let i,s=10;for(let o=0;o<a;o++)(i=game.add.sprite(s,7,"heart")).scale.setTo(1.2,1.2),t.add(i),e.push(i),s+=40}function setRemainingTime(e){return String(Math.trunc(e/60)).padStart(2,"0")+":"+String(e%60).padStart(2,"0")}function createExit(){exit=game.add.sprite(60,76,"exitClosed"),game.physics.arcade.enable(exit),exit.body.immovable=!0,exit.anchor.setTo(.5,.5),exit.x=800,exit.y=600,exit.smoothed=!1,exit.scale.setTo(1.7,1.7)}function timer(){time--,hudTime.setText(setRemainingTime(time)),0==time&&lose(time),game.time.events.add(Phaser.Timer.SECOND,timer)}function createSoundsLevel1(){dmgSound=game.add.audio("sndDamage"),endSound=game.add.audio("endsound"),exitSound=game.add.audio("exitsound"),candySound=game.add.audio("candysound"),shotSound=game.add.audio("shotSound"),zombieDeath=game.add.audio("zombieDeath"),collectPowerUp=game.add.audio("collectPowerUp")}function createBackgroundLevels(){tileNormal=game.add.tileSprite(0,0,1600,1200,"soilNormal"),createFast(),createSlow()}function createFast(){fastTiles=game.add.group();for(let e=0;e<TILES_SIZE;e++){let e=game.add.tileSprite(32*Math.floor(44*Math.random()),32*Math.floor(34*Math.random()),tileSizes[Math.round(Math.random()*tileSizes.length)],tileSizes[Math.round(Math.random()*tileSizes.length)],"soilFast");game.physics.arcade.enable(e),fastTiles.add(e)}}function createSlow(){slowTiles=game.add.group();for(let e=0;e<TILES_SIZE;e++){let e=game.add.tileSprite(32*Math.floor(44*Math.random()),32*Math.floor(34*Math.random()),tileSizes[Math.round(Math.random()*tileSizes.length)],tileSizes[Math.round(Math.random()*tileSizes.length)],"soilSlow");for(game.physics.arcade.enable(e);game.physics.arcade.overlap(e,fastTiles);)e.destroy(),e=game.add.tileSprite(32*Math.floor(44*Math.random()),32*Math.floor(34*Math.random()),tileSizes[Math.round(Math.random()*tileSizes.length)],tileSizes[Math.round(Math.random()*tileSizes.length)],"soilSlow"),game.physics.arcade.enable(e);slowTiles.add(e)}}function createSlimeLevels(e){slimeTrain=game.add.sprite(29,26,"slimeMove"),game.physics.arcade.enable(slimeTrain),slimeTrain.body.collideWorldBounds=!0,slimeTrain.x=400,slimeTrain.y=300,slimeTrain.anchor.setTo(.5,.5),slimeTrain.smoothed=!1,slimeTrain.scale.setTo(2,2),slimeTrain.animations.add("move"),lives=e,objLeft=WIN_OBJECTS_SIZE}function checkCoordinates(e,a,t,i,s,o){return!!(o>t&o<i&s>e&s<a)}function createNormalObjects(){normalObjects=game.add.group();for(let e=0;e<NORMAL_OBJECTS_SIZE;e++){let a;for(e<NORMAL_OBJECTS_SIZE/2?a=game.add.sprite(64,64,"bush"):(a=game.add.sprite(40,52,"tree")).scale.setTo(1.7,1.7),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;game.physics.arcade.overlap(a,normalObjects)||checkCoordinates(270,450,170,350,a.x,a.y)||checkCoordinates(660,850,460,650,a.x,a.y);)a.destroy(),e<NORMAL_OBJECTS_SIZE/2?a=game.add.sprite(64,64,"bush"):(a=game.add.sprite(40,52,"tree")).scale.setTo(1.7,1.7),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;normalObjects.add(a)}}function createDamageObjects(){damageObjects=game.add.group();for(let e=0;e<DAMAGE_OBJECTS_SIZE;e++){let a;for(e<DAMAGE_OBJECTS_SIZE/2?(a=game.add.sprite(19,22,"cactus")).scale.setTo(2,2):((a=game.add.sprite(161,165,"vortex")).scale.setTo(.5,.5),a.animations.add("vort"),a.animations.play("vort",7,!0)),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;game.physics.arcade.overlap(a,normalObjects)||game.physics.arcade.overlap(a,damageObjects)||checkCoordinates(270,450,170,350,a.x,a.y)||checkCoordinates(660,850,460,650,a.x,a.y);)a.destroy(),e<DAMAGE_OBJECTS_SIZE/2?(a=game.add.sprite(19,22,"cactus")).scale.setTo(2,2):((a=game.add.sprite(161,165,"vortex")).scale.setTo(.5,.5),a.animations.add("vort"),a.animations.play("vort",7,!0)),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;damageObjects.add(a)}}function createWinObjects(){winObjects=game.add.group();for(let e=0;e<WIN_OBJECTS_SIZE;e++){for((win=game.add.sprite(256,156,"candy")).scale.setTo(.25,.25),win.animations.add("candyAn"),win.animations.play("candyAn",2,!0),win.x=1520*Math.random(),win.y=1120*Math.random(),game.physics.arcade.enable(win),win.body.immovable=!0;game.physics.arcade.overlap(win,normalObjects)||game.physics.arcade.overlap(win,damageObjects)||game.physics.arcade.overlap(win,winObjects)||checkCoordinates(270,450,170,350,win.x,win.y)||checkCoordinates(660,850,460,650,win.x,win.y);)win.destroy(),(win=game.add.sprite(256,156,"candy")).scale.setTo(.25,.25),win.animations.add("candyAn"),win.animations.play("candyAn",2,!0),win.x=1520*Math.random(),win.y=1120*Math.random(),game.physics.arcade.enable(win),win.body.immovable=!0;winObjects.add(win)}}function createKeyControlsLevel1(){let e=document.getElementById("gamestage").children[0];e.addEventListener("mouseout",activateKeyboard),e.addEventListener("mouseover",deactivateKeyboard),cursors=game.input.keyboard.createCursorKeys(),rotateLeftTraining=game.input.keyboard.addKey(Phaser.Keyboard.LEFT),rotateRightTraining=game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),dashSlimeTraining=game.input.keyboard.addKey(Phaser.Keyboard.UP)}function updateLevel1(){moveSlimeLevels(),decreaseVelocityLevels(),moveCamera(),game.physics.arcade.collide(slimeTrain,normalObjects),game.physics.arcade.collide(slimeTrain,damageObjects,damageSlime),game.physics.arcade.overlap(slimeTrain,exit,touchExit),game.physics.arcade.overlap(slimeTrain,liveItems,pickLive),game.physics.arcade.overlap(slimeTrain,winObjects,pickObject)}function pickLive(e,a){lives<LEVEL_1_LIVES&&(a.kill(),collectPowerUp.play(),hearts[lives].reset(hearts[lives-1].x+40,7),lives++)}function pickObject(e,a){a.destroy(),candySound.play(),objLeft--,hudObjects.setText("Objects left: "+objLeft),0==objLeft&&(exit=game.add.sprite(60,76,"exitOpen"),game.physics.arcade.enable(exit),exit.body.immovable=!0,exit.anchor.setTo(.5,.5),exit.x=800,exit.y=600,exit.smoothed=!1,exit.scale.setTo(1.7,1.7),exitSound.play(),game.world.bringToTop(slimeTrain),game.world.bringToTop(hudGroup))}function touchExit(){0==objLeft&&(times.push(time),victory1=!0,exit.body.enable=!1,sc=2,slimeTrain.x=800,slimeTrain.y=600,end=!0,slimeTrain.body.immovable=!0,slimeTrain.body.velocity.x=0,slimeTrain.body.velocity.y=0,smoothTransition())}function smoothTransition(){slimeTrain.angle+=20,slimeTrain.scale.setTo(sc,sc),(sc-=.05)<.1?game.state.start("level2"):game.time.events.add(.05*Phaser.Timer.SECOND,smoothTransition)}function damageSlime(){inmunity||(inmunity=!0,dmgSound.play(),hearts[--lives].kill(),lives<=0?lose(time):(game.time.events.add(2*Phaser.Timer.SECOND,function(){inmunity=!1,slimeTrain.alpha=1}),alpha=.7,game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarDown)))}function alphaVarDown(){inmunity&&(slimeTrain.alpha-=.1,slimeTrain.alpha<=.3?game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarUp):game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarDown))}function alphaVarUp(){inmunity&&(slimeTrain.alpha+=.1,slimeTrain.alpha>=.7?game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarDown):game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarUp))}function lose(e){times.push(e),endSound.play(),game.state.start("endGame")}function moveSlimeLevels(){if(!end)if(0==control){if(0==slimeTrain.body.velocity.y&0==slimeTrain.body.velocity.x&&(slimeTrain.angle=180*Phaser.Math.angleBetween(slimeTrain.x,slimeTrain.y,game.input.x+game.camera.x,game.input.y+game.camera.y)/Math.PI+90),game.input.mousePointer.rightButton.duration>=0&&(holdDuration=game.input.mousePointer.rightButton.duration+500),game.input.activePointer.rightButton.justReleased(30)){let e=Math.cos((slimeTrain.angle-90)*Math.PI/180),a=Math.sin((slimeTrain.angle-90)*Math.PI/180);holdDuration>MAX_HOLD_DURATION&&(holdDuration=MAX_HOLD_DURATION),slimeTrain.body.velocity.y=a*DASH_VELOCITY*holdDuration/1e3,slimeTrain.body.velocity.x=e*DASH_VELOCITY*holdDuration/1e3,slimeTrain.animations.play("move",750/Math.abs(Math.sqrt(slimeTrain.body.velocity.y*slimeTrain.body.velocity.y+slimeTrain.body.velocity.x*slimeTrain.body.velocity.x)),!1)}}else if(1==control&&(0==slimeTrain.body.velocity.y&0==slimeTrain.body.velocity.x&rotateLeftTraining.isDown?slimeTrain.angle-=ROTATE_VELOCITY:0==slimeTrain.body.velocity.y&0==slimeTrain.body.velocity.x&rotateRightTraining.isDown&&(slimeTrain.angle+=ROTATE_VELOCITY),dashSlimeTraining.justUp)){let e=Math.cos((slimeTrain.angle-90)*Math.PI/180),a=Math.sin((slimeTrain.angle-90)*Math.PI/180),t=dashSlimeTraining.duration+500;t>MAX_HOLD_DURATION&&(t=MAX_HOLD_DURATION),slimeTrain.body.velocity.y=a*DASH_VELOCITY*t/1e3,slimeTrain.body.velocity.x=e*DASH_VELOCITY*t/1e3,slimeTrain.animations.play("move",750/Math.abs(Math.sqrt(slimeTrain.body.velocity.y*slimeTrain.body.velocity.y+slimeTrain.body.velocity.x*slimeTrain.body.velocity.x)),!1)}}function decreaseVelocityLevels(){(slimeTrain.body.velocity.y>0||slimeTrain.body.velocity.y<0)&&(slimeTrain.body.velocity.y/=1.012),(slimeTrain.body.velocity.x>0||slimeTrain.body.velocity.x<0)&&(slimeTrain.body.velocity.x/=1.012),Math.abs(Math.sqrt(slimeTrain.body.velocity.y*slimeTrain.body.velocity.y+slimeTrain.body.velocity.x*slimeTrain.body.velocity.x)<35)&&(slimeTrain.body.velocity.y=0,slimeTrain.body.velocity.x=0),game.physics.arcade.overlap(slimeTrain,fastTiles)?(slimeTrain.body.velocity.y*=1.009,slimeTrain.body.velocity.x*=1.009):6==slimeTrain.animations.frame&&(slimeTrain.body.velocity.y/=1.5,slimeTrain.body.velocity.x/=1.5),game.physics.arcade.overlap(slimeTrain,slowTiles)&&(slimeTrain.body.velocity.y/=1.01,slimeTrain.body.velocity.x/=1.01)}function debugHitBox(){cactuses.forEach(game.debug.body,game.debug,!0),game.debug.body(slime3)}const LEVEL_2_TIME=240,LEVEL_2_LIVES=4;let hudGroup2,hudLevel2,hudObjects2,hudPowerUps,hudHammer,hudShield,time2,hearts2,enemiesKilled,hammer,shield,haveHammer,haveShield,hammerBtn,shieldBtn,smoke,shieldActive,shieldIsActive,level2State={preload:preloadLevel2,create:createLevel2,update:updateLevel2};function preloadLevel2(){game.load.spritesheet("slimeMove","assets/imgs/SlimeMov.png",25,29,7),game.load.image("soilNormal","assets/imgs/DirtBlock.png"),game.load.image("soilFast","assets/imgs/IceBlock.png"),game.load.image("soilSlow","assets/imgs/MudBlock.png"),game.load.image("bush","assets/imgs/Bush.png"),game.load.image("rock","assets/imgs/rock.png"),game.load.image("heart","assets/imgs/heart.png"),game.load.image("shield","assets/imgs/shield.png"),game.load.image("hammer","assets/imgs/hammer.png"),game.load.image("shieldActive","assets/imgs/shieldActive.png"),game.load.image("shieldHud","assets/imgs/Invent_shield.png"),game.load.image("hammerHud","assets/imgs/Invent_Hammer.png"),game.load.image("smoke","assets/imgs/Smoke.png"),game.load.spritesheet("candy","assets/imgs/caramelo.png",256,156,2),game.load.spritesheet("fire","assets/imgs/fire.png",23,28,4),game.load.image("cactus","assets/imgs/cactus.png"),game.load.spritesheet("vortex","assets/imgs/Vortice.png",161,165,27),game.load.image("tree","assets/imgs/Tree.png"),game.load.image("exitClosed","assets/imgs/La_puerta_hacia_el_dorado_negro.png"),game.load.image("exitOpen","assets/imgs/La_puerta_hacia_el_dorado.png"),game.load.audio("sndDamage","assets/sounds/DamageSound.wav"),game.load.audio("endsound","assets/sounds/EndSound.wav"),game.load.audio("exitsound","assets/sounds/Exit.wav"),game.load.audio("candysound","assets/sounds/candy.wav"),game.load.audio("collectPowerUp","assets/sounds/CollectPowerUp.wav"),game.load.audio("hammerSound","assets/sounds/HammerSound.wav"),game.load.audio("shieldSound","assets/sounds/ShieldSound.wav"),game.load.spritesheet("slimeMutant","assets/imgs/ZombieMutante.png",25,26,2),game.load.spritesheet("slimeZombie","assets/imgs/zombieNormal.png",25,26,2),game.load.spritesheet("slimeShot","assets/imgs/SlimeShot.png",10,11,8),game.load.spritesheet("mutantShot","assets/imgs/mutantShot.png",8,8,8),game.load.audio("shotSound","assets/sounds/shotSound.wav"),game.load.audio("zombieDeath","assets/sounds/Explosion.wav"),game.load.spritesheet("zombieBlast","assets/imgs/zombieBlast.png",128,128)}function createLevel2(){musicMenu.pause(),musicLevel.isPlaying||musicLevel.play(),game.world.resize(1600,1200),createBackgroundLevels(),victory2=!1,hearts2=[],access1||(times=[]),createKeyControlsLevel1(),shotBtn=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),shieldBtn=game.input.keyboard.addKey(Phaser.Keyboard.X),hammerBtn=game.input.keyboard.addKey(Phaser.Keyboard.Z),createExit(),createSlimeLevels(LEVEL_2_LIVES),createShots(SHOTS_GROUP_SIZE),createNormalObjects2(),createDamageObjects2(),createWinObjects(),createLives(LEVEL_2_LIVES),createMutantShots(SHOTS_GROUP_SIZE),createMutantsLevel2(MUTANTS_GROUP_SIZE),createZombiesLevel2(ZOMBIES_GROUP_SIZE),createSoundsLevel2(),createBlasts(BLAST_GROUP_SIZE),createHammer(),createShield(),time2=LEVEL_2_TIME,currentLevel=2,enemiesKilled=0,access2=!0,createHUD2(),timer2(),end=!1,haveHammer=!1,haveShield=!1,shieldIsActive=!1,inmunity=!1}function createNormalObjects2(){normalObjects=game.add.group();for(let e=0;e<NORMAL_OBJECTS_SIZE;e++){let a;for(e<NORMAL_OBJECTS_SIZE/3?a=game.add.sprite(64,64,"bush"):e<2*NORMAL_OBJECTS_SIZE/3?(a=game.add.sprite(40,52,"tree")).scale.setTo(1.7,1.7):(a=game.add.sprite(30,30,"rock")).scale.setTo(2,2),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;game.physics.arcade.overlap(a,normalObjects)||checkCoordinates(270,450,170,350,a.x,a.y)||checkCoordinates(660,850,460,650,a.x,a.y);)a.destroy(),e<NORMAL_OBJECTS_SIZE/2?a=game.add.sprite(64,64,"bush"):(a=game.add.sprite(40,52,"tree")).scale.setTo(1.7,1.7),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;normalObjects.add(a)}}function createSoundsLevel2(){dmgSound=game.add.audio("sndDamage"),endSound=game.add.audio("endsound"),exitSound=game.add.audio("exitsound"),candySound=game.add.audio("candysound"),shotSound=game.add.audio("shotSound"),zombieDeath=game.add.audio("zombieDeath"),collectPowerUp=game.add.audio("collectPowerUp"),hammerSound=game.add.audio("hammerSound"),shieldSound=game.add.audio("shieldSound")}function createDamageObjects2(){damageObjects=game.add.group();for(let e=0;e<DAMAGE_OBJECTS_SIZE;e++){let a;for(e<DAMAGE_OBJECTS_SIZE/3?(a=game.add.sprite(19,22,"cactus")).scale.setTo(2,2):e<2*DAMAGE_OBJECTS_SIZE/3?((a=game.add.sprite(161,165,"vortex")).scale.setTo(.5,.5),a.animations.add("vort"),a.animations.play("vort",7,!0)):((a=game.add.sprite(23,28,"fire")).scale.setTo(2,2),a.animations.add("fire"),a.animations.play("fire",7,!0)),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;game.physics.arcade.overlap(a,normalObjects)||game.physics.arcade.overlap(a,damageObjects)||checkCoordinates(270,450,170,350,a.x,a.y)||checkCoordinates(660,850,460,650,a.x,a.y);)a.destroy(),e<DAMAGE_OBJECTS_SIZE/2?(a=game.add.sprite(19,22,"cactus")).scale.setTo(2,2):((a=game.add.sprite(161,165,"vortex")).scale.setTo(.5,.5),a.animations.add("vort"),a.animations.play("vort",7,!0)),a.x=1520*Math.random(),a.y=1120*Math.random(),game.physics.arcade.enable(a),a.body.immovable=!0;damageObjects.add(a)}}function createHammer(){for((hammer=game.add.sprite(104,64,"hammer")).scale.setTo(1,1),hammer.x=1520*Math.random(),hammer.y=1120*Math.random(),game.physics.arcade.enable(hammer),hammer.body.immovable=!0;game.physics.arcade.overlap(hammer,normalObjects)||game.physics.arcade.overlap(hammer,damageObjects)||game.physics.arcade.overlap(hammer,winObjects)||game.physics.arcade.overlap(hammer,winObjects)||game.physics.arcade.overlap(hammer,zombies)||checkCoordinates(270,450,170,350,hammer.x,hammer.y)||game.physics.arcade.overlap(hammer,mutants)||checkCoordinates(660,850,460,650,hammer.x,hammer.y);)hammer.destroy(),(hammer=game.add.sprite(104,64,"hammer")).scale.setTo(1,1),hammer.x=1520*Math.random(),hammer.y=1120*Math.random(),game.physics.arcade.enable(hammer),hammer.body.immovable=!0;game.world.sendToBack(hammer),game.world.sendToBack(fastTiles),game.world.sendToBack(slowTiles),game.world.sendToBack(tileNormal)}function createShield(){for((shield=game.add.sprite(32,32,"shield")).scale.setTo(1.3,1.3),shield.x=1520*Math.random(),shield.y=1120*Math.random(),game.physics.arcade.enable(shield),shield.body.immovable=!0;game.physics.arcade.overlap(shield,normalObjects)||game.physics.arcade.overlap(shield,damageObjects)||game.physics.arcade.overlap(shield,winObjects)||game.physics.arcade.overlap(shield,winObjects)||game.physics.arcade.overlap(shield,zombies)||checkCoordinates(270,450,170,350,hammer.x,hammer.y)||game.physics.arcade.overlap(shield,mutants)||checkCoordinates(660,850,460,650,hammer.x,hammer.y)||game.physics.arcade.overlap(shield,hammer);)shield.destroy(),(shield=game.add.sprite(104,64,"shield")).scale.setTo(1.3,1.3),shield.x=1520*Math.random(),shield.y=1120*Math.random(),game.physics.arcade.enable(shield),shield.body.immovable=!0}function createHUD2(){hudGroup2=game.add.group(),hudTime2=game.add.text(210,20,setRemainingTime(time2),HUD_STYLE_TIME),hudTime2.anchor.setTo(.5,.5),(hudLevel2=game.add.text(740,505,"Level: "+currentLevel,HUD_STYLE_TEXT)).anchor.setTo(.5,.5),(hudObjects2=game.add.text(700,540,"Objects left: "+objLeft,HUD_STYLE_TEXT)).anchor.setTo(.5,.5),(hudPowerUps=game.add.text(655,575,"Power ups: ",HUD_STYLE_TEXT)).anchor.setTo(.5,.5),hudGroup2.add(hudLevel2),hudGroup2.add(hudObjects2),hudGroup2.add(hudTime2),hudGroup2.add(hudPowerUps),createHearts(hearts2,LEVEL_2_LIVES,hudGroup2),hudGroup2.fixedToCamera=!0}function createMutantsLevel2(e){(mutants=game.add.group()).createMultiple(e,"slimeMutant"),mutants.callAll("anchor.setTo","anchor",.5,.5),mutants.callAll("scale.setTo","scale",2,2),mutants.forEach(placeMutantLevel2,this),mutants.forEach(function(e){game.time.events.add(2500,mutantShot,e,this)},this)}function placeMutantLevel2(e){let a=!1;for(;!a;){let t=1600*Math.random(),i=1200*Math.random();e.reset(t,i),game.physics.arcade.enable(e),e.body.immovable=!0,e.animations.add("mutantIdle"),e.animations.play("mutantIdle",4,!0),!(Phaser.Math.distance(slimeTrain.x,slimeTrain.y,t,i)>150)||game.physics.arcade.overlap(e,normalObjects)||game.physics.arcade.overlap(e,damageObjects)||game.physics.arcade.overlap(e,mutants)||game.physics.arcade.overlap(e,liveItems)||(a=!0)}}function createZombiesLevel2(e){(zombies=game.add.group()).createMultiple(e,"slimeZombie"),zombies.callAll("anchor.setTo","anchor",.5,.5),zombies.callAll("scale.setTo","scale",2,2),zombies.forEach(placeZombieLevel2,this),game.world.sendToBack(zombies),game.world.sendToBack(exit),game.world.sendToBack(fastTiles),game.world.sendToBack(slowTiles),game.world.sendToBack(tileNormal)}function placeZombieLevel2(e){let a=!1;for(;!a;){let t=1600*Math.random(),i=1200*Math.random();e.reset(t,i),game.physics.arcade.enable(e),e.body.immovable=!0,e.animations.add("slimeZombie"),e.animations.play("slimeZombie",4,!0),!(Phaser.Math.distance(slimeTrain.x,slimeTrain.y,t,i)>150)||game.physics.arcade.overlap(e,normalObjects)||game.physics.arcade.overlap(e,damageObjects)||game.physics.arcade.overlap(e,mutants)||game.physics.arcade.overlap(e,zombies)||game.physics.arcade.overlap(e,liveItems)||(a=!0)}}function updateLevel2(){moveSlimeLevels(),decreaseVelocityLevels(),manageShots(),moveCamera(),useHammer(),useShield(),game.physics.arcade.collide(mutants,slimeTrain),game.physics.arcade.collide(slimeTrain,normalObjects),game.physics.arcade.collide(slimeTrain,damageObjects,damageSlime2),game.physics.arcade.overlap(slimeTrain,winObjects,pickObject2),game.physics.arcade.overlap(shots,normalObjects,killShot),game.physics.arcade.overlap(shots,damageObjects,killShot),game.physics.arcade.overlap(mutants,shots,shotHitsEnemyLevel2,null,this),game.physics.arcade.overlap(zombies,shots,shotHitsEnemyLevel2,null,this),game.physics.arcade.overlap(slimeTrain,mutantShots,mutantShotHitsSlime,null,this),game.physics.arcade.collide(slimeTrain,zombies,damageSlime2),game.physics.arcade.overlap(slimeTrain,exit,touchExit2),game.physics.arcade.overlap(slimeTrain,hammer,pickHammer),game.physics.arcade.overlap(slimeTrain,shield,pickShield),game.physics.arcade.overlap(slimeTrain,liveItems,pickLive2),mutants.forEach(manageMutant,this),manageZombiesLevel2()}function pickLive2(e,a){lives<LEVEL_2_LIVES&&(a.kill(),collectPowerUp.play(),hearts2[lives].reset(hearts2[lives-1].x+40,7),lives++)}function pickHammer(){hammer.kill(),collectPowerUp.play(),haveHammer=!0,(hudHammer=game.add.sprite(16,16,"hammerHud")).scale.setTo(1.4,1.4),hudHammer.x=hudPowerUps.x+75,hudHammer.y=hudPowerUps.y-8,hudGroup2.add(hudHammer)}function pickShield(){shield.kill(),collectPowerUp.play(),haveShield=!0,(hudShield=game.add.sprite(16,16,"shieldHud")).scale.setTo(1.4,1.4),hudShield.x=hudPowerUps.x+105,hudShield.y=hudPowerUps.y-8,hudGroup2.add(hudShield)}function useHammer(){end||haveHammer&&hammerBtn.justDown&&(hudHammer.kill(),hammerSound.play(),smoke=game.add.sprite(38,33,"smoke"),game.physics.arcade.enable(smoke),smoke.anchor.setTo(.5,.5),smoke.alpha=.5,game.world.sendToBack(smoke),game.world.sendToBack(fastTiles),game.world.sendToBack(slowTiles),game.world.sendToBack(tileNormal),smoke.x=slimeTrain.x,smoke.y=slimeTrain.y,sc=1,growSmoke())}function useShield(){end||(shieldActive&&(shieldActive.x=slimeTrain.x,shieldActive.y=slimeTrain.y),haveShield&&shieldBtn.justDown&&(hudShield.kill(),shieldSound.play(),inmunity=!0,shieldActive=game.add.sprite(720,720,"shieldActive"),game.physics.arcade.enable(shieldActive),shieldActive.anchor.setTo(.5,.5),shieldActive.scale.setTo(.09,.09),shieldActive.x=slimeTrain.x,shieldActive.y=slimeTrain.y,game.time.events.add(10*Phaser.Timer.SECOND,function(){shieldActive.kill(),inmunity=!1,createShield()})))}function growSmoke(){smoke.scale.setTo(sc,sc),sc+=.1,smoke.x=slimeTrain.x,smoke.y=slimeTrain.y,game.physics.arcade.overlap(smoke,zombies,smokeDestroyer),game.physics.arcade.overlap(smoke,mutants,smokeDestroyer),game.physics.arcade.overlap(mutantShots,smoke,killShot),sc>10?(smoke.kill(),createHammer()):game.time.events.add(.01*Phaser.Timer.SECOND,growSmoke)}function smokeDestroyer(e,a){a.kill(),displayBlast(a),zombieDeath.play(),enemiesKilled++}function touchExit2(){0==objLeft&&(times.push(time2),victory2=!0,exit.body.enable=!1,sc=2,slimeTrain.x=800,slimeTrain.y=600,end=!0,slimeTrain.body.immovable=!0,slimeTrain.body.velocity.x=0,slimeTrain.body.velocity.y=0,inmunity=!0,smoothTransition2())}function smoothTransition2(){slimeTrain.angle+=20,slimeTrain.scale.setTo(sc,sc),(sc-=.05)<.1?game.state.start("endGame"):game.time.events.add(.05*Phaser.Timer.SECOND,smoothTransition2)}function manageZombiesLevel2(){countAngleSwitch++,zombies.forEach(manageZombieLevel2,this),countAngleSwitch==SWITCH_ANGLE_TIME&&(countAngleSwitch=0)}function manageZombieLevel2(e){if(!end&&(Phaser.Math.distance(slimeTrain.x,slimeTrain.y,e.x,e.y)<250&&e.alive?e.angle=180*Phaser.Math.angleBetween(e.x,e.y,slimeTrain.x,slimeTrain.y)/Math.PI+90:countAngleSwitch==SWITCH_ANGLE_TIME&&(e.angle+=60*Math.random()-30,e.y<30&&e.x<30?e.angle=135:e.y<30&&e.x>1570?e.angle=225:e.y>1170&&e.x>1570?e.angle=315:e.y>1170&&e.x<30?e.angle=45:(e.y<100?e.angle=180:e.y>1100&&(e.angle=0),e.x<100?e.angle=90:e.x>1500&&(e.angle=270))),!game.physics.arcade.collide(slimeTrain,e))){let a=Math.cos((e.angle-90)*Math.PI/180),t=Math.sin((e.angle-90)*Math.PI/180);e.x+=a/2,e.y+=t/2}}function mutantShotHitsSlime(e,a){a.kill(),damageSlime2()}function killShot(e,a){e.kill()}function pickObject2(e,a){a.destroy(),candySound.play(),objLeft--,hudObjects2.setText("Objects left: "+objLeft),0==objLeft&&(exit.kill(),exit=game.add.sprite(60,76,"exitOpen"),game.physics.arcade.enable(exit),exit.body.immovable=!0,exit.anchor.setTo(.5,.5),exit.x=800,exit.y=600,exit.smoothed=!1,exit.scale.setTo(1.7,1.7),exitSound.play(),game.world.sendToBack(exit),game.world.sendToBack(fastTiles),game.world.sendToBack(slowTiles),game.world.sendToBack(tileNormal))}function shotHitsEnemyLevel2(e,a){a.kill(),e.kill(),displayBlast(e),zombieDeath.play(),enemiesKilled++}function timer2(){time2--,hudTime2.setText(setRemainingTime(time2)),0==time2&&lose(time2),game.time.events.add(Phaser.Timer.SECOND,timer2)}function damageSlime2(){inmunity||(inmunity=!0,dmgSound.play(),hearts2[--lives].kill(),lives<=0?lose(time2):(game.time.events.add(2*Phaser.Timer.SECOND,function(){inmunity=!1,slimeTrain.alpha=1}),alpha=.7,game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarDown)))}const LEVEL_3_TIME=240,LEVEL_3_LIVES=5,LEVEL_3_CANDIES=10;let background,platforms,platformsIce,platformsMud,platformsSlime,ground,slime3,moveLeft3,moveRight3,jump3,shotBtn3,jumpAnim,moveAnim,chofAnim,air,speedMod,jumpMod,candies,candiesLeft,exit3,lives3,currentLives,hudGroup3,hudTime3,hudCandies3,hudLives3,hearts3,time3,mutants3,cactuses,trees,XPlat=[400,560,1280,1440,1440,1120,1374,1440,496,560,800,960],YPlat=[950,950,1050,1050,750,400,400,400,520,520,100,100],XPlatIce=[750,640,960,1120],YPlatIce=[750,1168,650,650],XPlatMud=[0,160,960,1120,1280,1440],YPlatMud=[310,310,1168,1168,1168,1168],XPlatSlime=[160,400,1280],YPlatSlime=[1168,520,400],XCandy=[380,1060,1510,580,970,780,1460,1460,370,420],YCandy=[60,60,20,410,610,710,710,1128,600,910],XLife=[30,1540,1540],YLife=[282,372,1022],XMutant=[430,980,1310,1150,1150,430,690],YMutant=[1142,1142,1024,624,374,494,494],XTrees=[590,190],YTrees=[958,318],XCactus=[815,1460,640,780],YCactus=[1148,380,1002,119],level3State={preload:preloadLevel3,create:createLevel3,update:updateLevel3};function preloadLevel3(){game.load.image("sky","assets/imgs/fondo2.png"),game.load.image("soilNormal","assets/imgs/Advanced/DirtBlock.png"),game.load.image("soilFast","assets/imgs/Advanced/IceBlock.png"),game.load.image("soilSlow","assets/imgs/Advanced/MudBlock.png"),game.load.image("soilJump","assets/imgs/Advanced/SlimeBlock.png"),game.load.spritesheet("slime","assets/imgs/Advanced/Slime3.png",29,26,13),game.load.image("heart","assets/imgs/heart.png"),game.load.spritesheet("candy","assets/imgs/caramelo.png",256,156,2),game.load.image("cactus","assets/imgs/cactus.png"),game.load.image("tree","assets/imgs/Tree.png"),game.load.image("exitClosed","assets/imgs/Advanced/La_puerta_hacia_el_dorado_negro_3.png"),game.load.image("exitOpen","assets/imgs/Advanced/La_puerta_hacia_el_dorado_3.png"),game.load.audio("sndDamage","assets/sounds/DamageSound.wav"),game.load.audio("endsound","assets/sounds/EndSound.wav"),game.load.audio("exitsound","assets/sounds/Exit.wav"),game.load.audio("candysound","assets/sounds/candy.wav"),game.load.spritesheet("slimeMutant","assets/imgs/Advanced/ZombieMutanteAdvanced.png",29,26,6),game.load.spritesheet("slimeShot","assets/imgs/SlimeShot.png",10,11,8),game.load.spritesheet("mutantShot","assets/imgs/mutantShot.png",8,8,8),game.load.audio("sndDamage","assets/sounds/DamageSound.wav"),game.load.audio("endsound","assets/sounds/EndSound.wav"),game.load.audio("exitsound","assets/sounds/Exit.wav"),game.load.audio("candysound","assets/sounds/candy.wav"),game.load.audio("collectPowerUp","assets/sounds/CollectPowerUp.wav"),game.load.audio("hammerSound","assets/sounds/HammerSound.wav"),game.load.audio("shieldSound","assets/sounds/ShieldSound.wav"),game.load.audio("shotSound","assets/sounds/shotSound.wav"),game.load.audio("zombieDeath","assets/sounds/Explosion.wav"),game.load.spritesheet("zombieBlast","assets/imgs/zombieBlast.png",128,128)}function createLevel3(){musicMenu.pause(),musicLevel.isPlaying||musicLevel.play(),game.world.resize(1600,1200),access3=!0,createControlKeys3(),createBackgroundLevel3(),createGround(),createExit3(),createLives3(),createSlime3(),createMutants3(),createCactus(),createTrees(),createSoundsLevel2(),createBlasts(BLAST_GROUP_SIZE),createMutantShots(SHOTS_GROUP_SIZE),createCandies(LEVEL_3_CANDIES),air=!0,inmunity=!1,victory3=!1,speedMod=1,jumpMod=1,candiesLeft=LEVEL_3_CANDIES,currentLives=LEVEL_3_LIVES,hearts3=[],times=[],time3=LEVEL_3_TIME,createHUD3(),timer3(),createShots(SHOTS_GROUP_SIZE),enemiesKilled=0,end=!1}function createHUD3(){hudGroup3=game.add.group(),(hudTime3=game.add.text(250,20,setRemainingTime(time3),HUD_STYLE_TIME)).anchor.setTo(.5,.5),hudLevel3=game.add.text(740,540,"Level: 3",HUD_STYLE_TEXT),hudLevel3.anchor.setTo(.5,.5),(hudCandies3=game.add.text(700,574,"Candies left: "+candiesLeft,HUD_STYLE_TEXT)).anchor.setTo(.5,.5),hudGroup3.add(hudLevel3),hudGroup3.add(hudCandies3),hudGroup3.add(hudTime3),createHearts(hearts3,LEVEL_3_LIVES,hudGroup3),hudGroup3.fixedToCamera=!0}function createControlKeys3(){moveLeft3=game.input.keyboard.addKey(Phaser.Keyboard.LEFT),moveRight3=game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),jump3=game.input.keyboard.addKey(Phaser.Keyboard.UP),shotBtn3=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)}function createBackgroundLevel3(){(background=game.add.tileSprite(0,0,800,600,"sky")).scale.setTo(2,2)}function createGround(){platforms=game.add.group();for(let e=0;e<960;e+=160)640!=e&&((ground=game.add.sprite(160,32,"soilNormal")).x=160==e?256:e,ground.y=1168,platforms.add(ground),game.physics.arcade.enable(ground),ground.body.immovable=!0);createNormalPlatforms(),createIcePlatforms(),createMudPlatforms(),createSlimePlatforms()}function createNormalPlatforms(){for(let e=0;e<XPlat.length;e++){let a,t=XPlat[e],i=YPlat[e];(a=game.add.sprite(160,32,"soilNormal")).x=t,a.y=i,platforms.add(a),game.physics.arcade.enable(a),a.body.immovable=!0}}function createIcePlatforms(){platformsIce=game.add.group();for(let e=0;e<XPlatIce.length;e++){let a,t=XPlatIce[e],i=YPlatIce[e];(a=game.add.sprite(160,32,"soilFast")).x=t,a.y=i,platformsIce.add(a),game.physics.arcade.enable(a),a.body.immovable=!0}}function createMudPlatforms(){platformsMud=game.add.group();for(let e=0;e<XPlatMud.length;e++){let a,t=XPlatMud[e],i=YPlatMud[e];(a=game.add.sprite(160,32,"soilSlow")).x=t,a.y=i,platformsMud.add(a),game.physics.arcade.enable(a),a.body.immovable=!0}}function createSlimePlatforms(){platformsSlime=game.add.group();for(let e=0;e<XPlatSlime.length;e++){let a,t=XPlatSlime[e],i=YPlatSlime[e];(a=game.add.sprite(96,32,"soilJump")).x=t,a.y=i,platformsSlime.add(a),game.physics.arcade.enable(a),a.body.immovable=!0}}function createTrees(){trees=game.add.group();for(let e=0;e<XTrees.length;e++){let a,t=XTrees[e],i=YTrees[e];(a=game.add.sprite(40,52,"tree")).x=t,a.y=i,trees.add(a),a.anchor.setTo(1,1),a.scale.setTo(1.5,1.5),game.physics.arcade.enable(a),a.body.immovable=!0}}function createCactus(){cactuses=game.add.group();for(let e=0;e<XCactus.length;e++){let a,t=XCactus[e],i=YCactus[e];a=game.add.sprite(19,22,"cactus"),game.physics.arcade.enable(a),a.anchor.setTo(.5,.5),a.scale.setTo(1.8,1.8),3==e?a.angle=270:2==e&&(a.angle=180),a.x=t,a.y=i,cactuses.add(a),a.body.immovable=!0}}function createExit3(){exit3=game.add.sprite(60,62,"exitClosed"),game.physics.arcade.enable(exit3),exit3.body.immovable=!0,exit3.anchor.setTo(0,1),exit3.x=820,exit3.y=100,exit3.smoothed=!1,exit3.scale.setTo(1.5,1.5)}function createSlime3(){slime3=game.add.sprite(29,26,"slime",11),game.physics.arcade.enable(slime3),slime3.anchor.setTo(.5,.5),slime3.scale.setTo(2,2),slime3.body.collideWorldBounds=!0,slime3.x=50,slime3.y=550,slime3.body.gravity.y=400,jumpAnim=slime3.animations.add("jump",[11,2,3,4,5,6,7,8,9,11]),moveAnim=slime3.animations.add("move",[11,12]),chofAnim=slime3.animations.add("chof",[0])}function createMutants3(){mutants3=game.add.group();for(let e=0;e<XMutant.length;e++){let a,t=XMutant[e],i=YMutant[e];(a=game.add.sprite(174,26,"slimeMutant",6)).scale.setTo(2,2),a.anchor.setTo(.5,.5),a.animations.add("mutant"),a.animations.play("mutant",6,!0),a.x=t,a.y=i,mutants3.add(a),game.physics.arcade.enable(a),a.body.immovable=!0}mutants3.forEach(function(e){game.time.events.add(2e3,mutantShot3,e,this)},this)}function createLives3(){lives3=game.add.group();for(let e=0;e<XLife.length;e++){let a,t=XLife[e],i=YLife[e];(a=game.add.sprite(28,24,"heart")).x=t,a.y=i,lives3.add(a),game.physics.arcade.enable(a),a.body.immovable=!0}}function createCandies(e){candies=game.add.group();for(let e=0;e<XCandy.length;e++){let a,t=XCandy[e],i=YCandy[e];(a=game.add.sprite(256,156,"candy")).scale.setTo(.25,.25),a.animations.add("candy"),a.animations.play("candy",2,!0),a.x=t,a.y=i,candies.add(a),game.physics.arcade.enable(a),a.body.immovable=!0}}function timer3(){time3--,hudTime3.setText(setRemainingTime(time3)),0==time3&&lose(time3),game.time.events.add(Phaser.Timer.SECOND,timer3)}function updateLevel3(){moveCamera3(),moveSlime3(),game.physics.arcade.collide(slime3,platforms,goNormal),game.physics.arcade.collide(slime3,platformsIce,gottaGoFast),game.physics.arcade.collide(slime3,platformsMud,gottaGoSlow),game.physics.arcade.collide(slime3,platformsSlime,gottaJump),game.physics.arcade.overlap(slime3,candies,pickCandy),game.physics.arcade.overlap(slime3,lives3,pickLife),game.physics.arcade.collide(slime3,mutants3,hitSlime),game.physics.arcade.collide(slime3,cactuses,hitSlime),game.physics.arcade.collide(slime3,trees),game.physics.arcade.overlap(shots,platforms,killShot),game.physics.arcade.overlap(shots,platformsIce,killShot),game.physics.arcade.overlap(shots,platformsMud,killShot),game.physics.arcade.overlap(shots,platformsSlime,killShot),game.physics.arcade.overlap(shots,candies,killShot),game.physics.arcade.overlap(shots,lives3,killShot),game.physics.arcade.overlap(mutants3,shots,shotHitsEnemyLevel2),game.physics.arcade.overlap(shots,cactuses,killShot),game.physics.arcade.overlap(shots,trees,killShot),game.physics.arcade.overlap(slime3,mutantShots,mutantShotHitsSlime3),game.physics.arcade.overlap(slime3,exit3,touchExit3),manageShots3(),mutants3.forEach(manageMutant3),decreaseVelocity3(),chof()}function touchExit3(){0==candiesLeft&&(times.push(time3),victory3=!0,exit3.body.enable=!1,sc=2,slime3.x=865,slime3.y=54,end=!0,slime3.body.immovable=!0,slime3.body.velocity.x=0,slime3.body.velocity.y=0,inmunity=!0,slime3.body.gravity.y=0,smoothTransition3())}function smoothTransition3(){slime3.angle+=20,slime3.scale.setTo(sc,sc),(sc-=.05)<.1?game.state.start("endGame"):game.time.events.add(.05*Phaser.Timer.SECOND,smoothTransition3)}function mutantShotHitsSlime3(e,a){a.kill(),hitSlime()}function manageMutant3(e){Phaser.Math.distance(e.x,e.y,slime3.x,slime3.y)<400&&(slime3.x<e.x?e.scale.setTo(2,2):e.scale.setTo(-2,2))}function mutantShot3(e){if(Phaser.Math.distance(slime3.x,slime3.y,e.x,e.y)<400&&e.alive){let a;a=e.scale.x>0?-1:1,shoot(e.x+a+25*a,e.y,300*a,0,"mutantShot",mutantShots,90*a)}game.time.events.add(1500,mutantShot3,e,this)}function manageShots3(){if(shotBtn3.justDown){let e;e=slime3.scale.x>0?1:-1,shoot(slime3.x+e+25*e,slime3.y,400*e,0,"slimeShot",shots,90*e)&&shotSound.play()}}function hitSlime(){inmunity||(inmunity=!0,dmgSound.play(),hearts3[--currentLives].kill(),currentLives<=0?lose(time3):(game.time.events.add(2*Phaser.Timer.SECOND,function(){inmunity=!1,slime3.alpha=1}),alpha=.7,game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarDown3)))}function alphaVarDown3(){inmunity&&(slime3.alpha-=.1,slime3.alpha<=.3?game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarUp3):game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarDown3))}function alphaVarUp3(){inmunity&&(slime3.alpha+=.1,slime3.alpha>=.7?game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarDown3):game.time.events.add(.05*Phaser.Timer.SECOND,alphaVarUp3))}function pickLife(e,a){currentLives<LEVEL_3_LIVES&&(a.kill(),collectPowerUp.play(),hearts3[currentLives].reset(hearts3[currentLives-1].x+40,7),currentLives++)}function pickCandy(e,a){a.kill(),candiesLeft--,candySound.play(),hudCandies3.setText("Candies left: "+candiesLeft),0==candiesLeft&&(exit3=game.add.sprite(60,62,"exitOpen"),game.physics.arcade.enable(exit3),exit3.body.immovable=!0,exit3.anchor.setTo(0,1),exit3.x=820,exit3.y=100,exit3.smoothed=!1,exit3.scale.setTo(1.5,1.5),exitSound.play(),game.world.bringToTop(slime3),game.world.bringToTop(hudGroup3))}function gottaGoFast(){speedMod=1.8,jumpMod=1}function gottaJump(){speedMod=1,jumpMod=1.25}function gottaGoSlow(){speedMod=.35,jumpMod=.7}function goNormal(){speedMod=1,jumpMod=1}function chof(){!air&&slime3.body.velocity.y>0&&(air=!0),air&&0==slime3.body.velocity.y&&(air=!1,slime3.animations.play("chof",5.25,!1))}function moveCamera3(){end||(game.camera.x=slime3.x-400,game.camera.y=slime3.y-235)}function moveSlime3(){end||(jump3.isDown&&(game.physics.arcade.collide(slime3,platforms)||game.physics.arcade.collide(slime3,platformsIce)||game.physics.arcade.collide(slime3,platformsMud)||game.physics.arcade.collide(slime3,platformsSlime))&&!chofAnim.isPlaying&&!air&&(slime3.animations.play("jump",7.5,!1),slime3.body.velocity.y-=450*jumpMod,air=!0),moveLeft3.isDown&&moveRight3.isDown||chofAnim.isPlaying||(moveLeft3.isDown?(slime3.scale.setTo(-2,2),moveAnim.isPlaying||jumpAnim.isPlaying||slime3.animations.play("move",3,!1),slime3.body.velocity.x>-275*speedMod&&(slime3.body.velocity.x-=50)):moveRight3.isDown&&(slime3.scale.setTo(2,2),moveAnim.isPlaying||jumpAnim.isPlaying||slime3.animations.play("move",3,!1),slime3.body.velocity.x<275*speedMod&&(slime3.body.velocity.x+=50))))}function decreaseVelocity3(){(slime3.body.velocity.x>0||slime3.body.velocity.x<0)&&(slime3.body.velocity.x/=1.045),Math.abs(slime3.body.velocity.x)<35&&(slime3.body.velocity.x=0)}const ENDGAME_STYLE_DEFEAT={font:"bold 30pt Pacifico",fontWeight:"bold",fill:"red"},ENDGAME_STYLE_WIN={font:"bold 30pt Pacifico",fontWeight:"bold",fill:"#e312e5"},ENDGAME_STYLE_REPLAY={font:"bold 15pt Pacifico",fontWeight:"bold",fill:"orange"};let timeOver,btnBack,playAgain,GameOver,win,endSound,enemies,replay,endGameState={preload:preloadEnd,create:createEnd,update:updateEnd};function preloadEnd(){game.world.resize(800,600),game.load.image("end","assets/imgs/GameOver.png"),game.load.image("win","assets/imgs/Victory.png"),game.load.image("btnBack","assets/imgs/btnBack.png")}function createEnd(){musicLevel.pause(),musicMenu.play(),game.input.enabled=!0,game.time.events.add(30*Phaser.Timer.SECOND,backToStart,this),access3&victory3?(win=game.add.image(0,0,"win"),displayTimeLevel3(times,ENDGAME_STYLE_WIN),enemies=game.add.text(game.world.width/3,game.world.height/1.2,"Killed enemies: "+enemiesKilled,ENDGAME_STYLE_WIN)):access3?(GameOver=game.add.image(0,0,"end"),displayTimeLevel3(times,ENDGAME_STYLE_DEFEAT),enemies=game.add.text(game.world.width/3,game.world.height/1.2,"Killed enemies: "+enemiesKilled,ENDGAME_STYLE_DEFEAT)):access1&&!victory1?(GameOver=game.add.image(0,0,"end"),displayTime(times,ENDGAME_STYLE_DEFEAT)):access1&&access2&&!victory2?(GameOver=game.add.image(0,0,"end"),displayTime(times,ENDGAME_STYLE_DEFEAT),enemies=game.add.text(game.world.width/3,game.world.height/1.2,"Killed enemies: "+enemiesKilled,ENDGAME_STYLE_DEFEAT)):access1&&access2&&victory2?(win=game.add.image(0,0,"win"),displayTime(time,ENDGAME_STYLE_WIN),enemies=game.add.text(game.world.width/3,game.world.height/1.2,"Killed enemies: "+enemiesKilled,ENDGAME_STYLE_WIN)):!access1&&access2&&victory2?(GameOver=game.add.image(0,0,"win"),displayTimeLevel2(times,ENDGAME_STYLE_WIN),enemies=game.add.text(game.world.width/3,game.world.height/1.2,"Killed enemies: "+enemiesKilled,ENDGAME_STYLE_WIN)):(GameOver=game.add.image(0,0,"end"),displayTimeLevel2(times,ENDGAME_STYLE_DEFEAT),enemies=game.add.text(game.world.width/3,game.world.height/1.2,"Killed enemies: "+enemiesKilled,ENDGAME_STYLE_DEFEAT)),createButtonGameOver(),replay=game.add.text(10,520,'Press "R"\n to play again',ENDGAME_STYLE_REPLAY),playAgain=game.input.keyboard.addKey(Phaser.Keyboard.R)}function createButtonGameOver(){(btnBack=game.add.button(750,550,"btnBack",backToStart)).scale.setTo(.4,.4),btnBack.scale.setTo(.2,.2),btnBack.anchor.setTo(.5,.5),btnBack.onInputOver.add(growT),btnBack.onInputOut.add(smallerT)}function backToStart(){game.state.start("init")}function checkPlayAgain(){playAgain.justDown&&(access3?game.state.start("level3"):game.state.start("level1"))}function displayTime(e,a){let t=10;for(let i=0;i<times.length;i++)timeOver=game.add.text(game.world.width/4,game.world.height/1.6+t,"Time left level "+(i+1)+": "+setRemainingTime(e[i]),a),t+=50}function displayTimeLevel2(e,a){let t=10;for(let i=0;i<times.length;i++)timeOver=game.add.text(game.world.width/4,game.world.height/1.6+t,"Time left level 2: "+setRemainingTime(e[i]),a),t+=50}function displayTimeLevel3(e,a){let t=10;for(let i=0;i<times.length;i++)timeOver=game.add.text(game.world.width/4,game.world.height/1.6+t,"Time left level 3: "+setRemainingTime(e[i]),a),t+=50}function updateEnd(){checkPlayAgain()}let trainingState={preload:preloadTraining,create:createTraining};function preloadTraining(){game.load.image("buttonTR1","assets/imgs/ButtonTrain1.png"),game.load.image("buttonTR2","assets/imgs/ButtonTrain2.png"),game.load.image("buttonBack","assets/imgs/btnBack.png")}function createTraining(){fondo1=game.add.image(0,0,"fondo1"),titulo=game.add.image(265,20,"titulo"),titulo.scale.setTo(3,3),titulo.smoothed=!1,btnTrain1=game.add.button(150,300,"buttonTR1",startTrain1),btnTrain1.scale.setTo(.6,.6),btnTrain1.anchor.setTo(.5,.5),btnTrain1.onInputOver.add(grow),btnTrain1.onInputOut.add(smaller),btnTrain2=game.add.button(650,300,"buttonTR2",startTrain2),btnTrain2.scale.setTo(.6,.6),btnTrain2.anchor.setTo(.5,.5),btnTrain2.onInputOver.add(grow),btnTrain2.onInputOut.add(smaller),createButtonAbout(),createSlimeTrainInit(),createZombieTrainInit1(),createZombieTrainInit2()}function createSlimeTrainInit(){(slime=game.add.button(29,26,"slimeJump",createSlimeBlastTrainInit)).x=350,slime.y=300,slime.smoothed=!1,slime.scale.setTo(4,4),animSLime=slime.animations.add("jump"),slime.animations.play("jump",6,!0)}function createSlimeBlastTrainInit(){xi=slime.x,yi=slime.y,slime.kill(),(slime=game.add.sprite(29,26,"slimeBlast")).x=xi-35,slime.y=yi-40,slime.scale.setTo(1.5,1.5),animSLime=slime.animations.add("slimeBlast"),slime.animations.play("slimeBlast",17,!1),game.time.events.add(1500,createSlimeTrainInit,this),soundExpl.play()}function createZombieTrainInit1(){zombie1=game.add.button(29,26,"zombie1",createZombieBlastTrainInit1),zombie1.x=275,zombie1.y=400,zombie1.smoothed=!1,zombie1.scale.setTo(-4,4),animZombie1=zombie1.animations.add("animZombie1"),zombie1.animations.play("animZombie1",6,!0)}function createZombieBlastTrainInit1(){xi=zombie1.x,yi=zombie1.y,zombie1.kill(),zombie1=game.add.sprite(29,26,"zombieBlast"),zombie1.x=120,zombie1.y=yi-40,zombie1.scale.setTo(1.5,1.5),soundExpl.play(),animZombie1=zombie1.animations.add("zombieBlast"),zombie1.animations.play("zombieBlast",17,!1),game.time.events.add(1500,createZombieTrainInit1,this)}function createZombieTrainInit2(){zombie2=game.add.button(29,26,"zombie1",createZombieBlastTrainInit2),zombie2.x=550,zombie2.y=400,zombie2.smoothed=!1,zombie2.scale.setTo(4,4),animZombie2=zombie2.animations.add("animZombie2"),zombie2.animations.play("animZombie2",6,!0)}function createZombieBlastTrainInit2(){xi=zombie2.x,yi=zombie2.y,zombie2.kill(),zombie2=game.add.sprite(29,26,"zombieBlast"),zombie2.x=xi-35,zombie2.y=yi-40,zombie2.scale.setTo(1.5,1.5),soundExpl.play(),animZombie2=zombie2.animations.add("zombieBlast"),zombie2.animations.play("zombieBlast",17,!1),game.time.events.add(1500,createZombieTrainInit2,this)}function startTrain1(){game.state.start("train1")}function startTrain2(){game.state.start("train2")}const GAME_STAGE_WIDTH=800,GAME_STAGE_HEIGHT=600;let musicMenu=null,musicLevel=null,game=new Phaser.Game(800,600,Phaser.CANVAS,"gamestage");window.onload=startGame;let wfConfig={google:{families:["Pacifico","Lobster","Abril Fatface","Baloo Da"]}};function startGame(){game.canvas.oncontextmenu=function(e){e.preventDefault()},game.state.add("init",initState),game.state.add("about",aboutState),game.state.add("training",trainingState),game.state.add("train1",trainState1),game.state.add("train2",trainState2),game.state.add("levels",levelsState),game.state.add("level1",level1State),game.state.add("level2",level2State),game.state.add("level3",level3State),game.state.add("endGame",endGameState),game.state.start("init")}WebFont.load(wfConfig);